{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>"},{"location":"#digital-forensics-investigative-questions","title":"Digital Forensics Investigative Questions","text":"<p>DFIQ is a collection of Digital Forensics Investigative Questions and the approaches to answering them. The goal of the project is to build a comprehensive catalog of investigative knowledge to help drive  consistent, thorough, and explainable investigations.</p>"},{"location":"#key-aspects-of-dfiq","title":"Key Aspects of DFIQ:","text":"<ul> <li>DFIQ is a catalog of investigative knowledge, centered on Questions</li> <li>Uses the concept of Scenarios to logically group Questions and help structure investigations</li> <li>Stores data in an easily-readable, tool-agnostic format (YAML) to be used by others</li> </ul> <p>"},{"location":"#get-started","title":"Get Started!","text":"<p>View Questions View Scenarios </p>"},{"location":"contributing/approach_glossary/","title":"Approach Glossary","text":"<p>DFIQ's Approaches contain the important \"how\" to answer the Questions. Approaches are also the most complicated part of DFIQ, due to the amount of structured information they contain. DFIQ has a detailed specification that is a useful reference for creating new Approaches. However, some parts of Approaches need user-defined values that are beyond the specification. This page is a glossary of currently-used values, generated from the DFIQ YAML files.</p> <p>When writing new Approaches, check this glossary first to see if there's already an existing term that fits with what you're trying to do. If not, you are free to create a new one, but trying to reuse existing terms first will increase consistency throughout DFIQ. These concepts (data type, processors, analysis steps) also may not be straight-forward at first; the hope is that seeing some common values (and the linked usages) will help make them more clear.</p>"},{"location":"contributing/approach_glossary/#data","title":"Data","text":"<p>This section (<code>view.data</code>) can have multiple ways describing the data needed for this approach. They should be thought of as complementary or as alternates to each other (they can be \"OR\"d together, they do not need to be \"AND\"d). Each is specified by a pair of <code>type</code> and <code>value</code>.</p> <p>Example (from Q1001.10):</p> <pre><code>view:\n  data:\n    - type: ForensicArtifact\n      value: BrowserHistory\n</code></pre> <p>Below are the current values of <code>type</code>, along with the <code>value</code>s set for each.</p>"},{"location":"contributing/approach_glossary/#crowdstrike","title":"CrowdStrike","text":"<p>For <code>type: CrowdStrike</code>, current entries for <code>value</code>:</p> <ul> <li>DnsRequest</li> <li>PlatformEvents</li> <li>ProcessRollup</li> </ul>"},{"location":"contributing/approach_glossary/#forensicartifact","title":"ForensicArtifact","text":"<p>Description: This corresponds to the name of a ForensicArtifact, an existing repository of machine-readable digital forensic artifacts (https://github.com/ForensicArtifacts/artifacts). Using this type is preferred when the data is a host-based file/artifact, but other methods are available as well (if there isn't an existing relevant ForensicArtifact).</p> <p>For <code>type: ForensicArtifact</code>, current entries for <code>value</code>:</p> <ul> <li>BrowserHistory</li> <li>NTFSUSNJournal</li> <li>SantaLogs</li> <li>WindowsEventLogs</li> <li>WindowsPrefetchFiles</li> <li>WindowsXMLEventLogSysmon</li> </ul>"},{"location":"contributing/approach_glossary/#description","title":"description","text":"<p>Description: Text description of the data type. <code>description</code> is often using in conjunction with another data type to provide more context. It can also be used alone, either as a placeholder or when more robust, programmatic data types do not fit.</p> <p>For <code>type: description</code>, current entries for <code>value</code>:</p> <ul> <li>Collect local browser history artifacts. These are often in the form of SQLite databases and JSON files in multiple directories.</li> <li>Files used by the Windows Prefetch service.</li> <li>Santa logs stored on the local disk; they may also be centralized off-system, but this artifact does not include those.</li> <li>The NTFS $UsnJnrl file system metadata file. This ForensicArtifact definition does not include the $J alternate data stream, but many tools collect it anyway.</li> <li>Windows Event Log files</li> </ul>"},{"location":"contributing/approach_glossary/#processors","title":"Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data an investigator reviews. Multiple processors can be defined, as there are often multiple programs capable of doing similar processing (example: log2timeline, Magnet Axiom, and Hindsight can all process browser history artifacts and deliver similar results).</p> <p>Example (from Q1001.10):</p> <pre><code>  processors:\n    - name: Plaso\n</code></pre> <p>Below are the currently-defined processors:</p> <ul> <li>Crowdstrike Investigate (UI) \ud83d\udd0e</li> <li>Hindsight \ud83d\udd0e</li> <li>Plaso \ud83d\udd0e</li> <li>Splunk \ud83d\udd0e</li> </ul>"},{"location":"contributing/approach_glossary/#analysis-steps","title":"Analysis Steps","text":"<p>Under each analysis method will be a sequence of one or more maps with keys <code>description</code>, <code>type</code>, and <code>value</code>. If there is more than one map, they should be processed in sequence in the analysis method (if applicable). In this way, we can describe multiple chained steps of analysis (with the <code>description</code> being a way to communicate to the user what exactly each \"step\" is doing, enabling a \"show-your-work\"-type capability).</p> <p>Example (from Q1001.10):</p> <pre><code>      analysis:\n        - name: OpenSearch\n          steps:\n            - description: &amp;filter-desc Filter the results to just file downloads\n              type: opensearch-query\n              value: data_type:(\"chrome:history:file_downloaded\" OR \"safari:downloads:entry\")\n        - name: Python Notebook\n          steps:\n            - description: *filter-desc\n              type: pandas\n              value: query('data_type in (\"chrome:history:file_downloaded\", \"safari:downloads:entry\")')\n</code></pre>"},{"location":"contributing/approach_glossary/#type","title":"<code>type</code>","text":"<p>The contents of the <code>description</code> and <code>value</code> fields will vary wildly with little repetition, depending on what the analysis step is doing, but the step <code>type</code> should be one of a few common values.</p> <p>Below are the currently-defined values of <code>type</code>:</p> <ul> <li>GUI \ud83d\udd0e</li> <li>manual \ud83d\udd0e</li> <li>opensearch-query \ud83d\udd0e</li> <li>pandas \ud83d\udd0e</li> <li>splunk-query \ud83d\udd0e</li> </ul>"},{"location":"contributing/approach_glossary/#variable-substitution-in-step-value","title":"Variable Substitution in step <code>value</code>","text":"<p>The step's <code>value</code> may benefit from some using a specific term to make the step more precise. Common examples of this include adding time bounds and filtering down to a specific identifier (user name, host, FQDN, or PID, for example).</p> <p>DFIQ's convention for denoting a variable to be substituted when used is to wrap the term in { }.</p> <p>==More standardization is needed here to define common variables (such as timestamps in a particular format).==</p> <p>Below are the currently-used variables in analysis steps:</p> <ul> <li>{file_reference value} \ud83d\udd0e</li> <li>{hostname} \ud83d\udd0e</li> </ul>"},{"location":"contributing/specification/","title":"DFIQ Specification","text":"<p>Version: 1.0.0</p>"},{"location":"contributing/specification/#introduction","title":"Introduction","text":"<p>The DFIQ (Digital Forensics Investigative Questions) Specification defines a standard, language-agnostic interface for digital forensic investigations. This means that it can be used with any type of data, regardless of the tool or  platform it is stored in. This allows both humans and machines to work together on digital forensic investigations.  Machines can be used to automate tasks, such as data collection and processing, while humans can use their expertise  to interpret the data and identify potential evidence. The DFIQ Specification also helps to ensure that digital  forensic investigations are conducted in a consistent and reliable manner.</p>"},{"location":"contributing/specification/#versions","title":"Versions","text":"<p>The DFIQ Specification is versioned using a major.minor.patch scheme (semantic versioning). The <code>major.minor</code> portion designates the feature set. Patch versions address errors or provide clarifications.</p> <p>Tooling which supports version 1.1 SHOULD be compatible with all 1.1.* versions. The patch version SHOULD NOT be  considered by tooling, making no distinction between 3.1.0 and 3.1.1 for example.</p> <p>A DFIQ document must include a dfiq_version field with the version.</p>"},{"location":"contributing/specification/#format","title":"Format","text":"<p>A DFIQ document that conforms to the DFIQ Specification is represented in YAML.</p>"},{"location":"contributing/specification/#identifiers","title":"Identifiers","text":"<p><pre><code> Q1024.12\n \u2514\u2500\u2500\u253c\u2500\u2500\u2500\u253c\u2500\u2500 First character indicates type (Scenario, Facet, or Question)\n    \u2514\u2500\u2500\u2500\u253c\u2500\u2500 4-digit number*, unique per type \n        \u2514\u2500\u2500 [optional] 2-digit number* indicates this is an Approach, \n            specific to the Question\n</code></pre> Both the 4- and 2-digit numbers start with a 1 (or higher) for components appropriate for external use. Numbers  starting with a 0 are reserved for internal use (think of it like private IP address space). Users of DFIQ can use  these IDs for their internal components without worrying about collisions with public components.  DFIQ on GitHub will serve as the definitive central repository to manage public DFIQ components (and their IDs).</p>"},{"location":"contributing/specification/#schema","title":"Schema","text":"<p>Below are the schemas for the different DFIQ components: Scenario, Facet, Question, and Approach. Each DFIQ component is typically saved as its own YAML file, named after its DFIQ ID  (example: <code>S1001.yaml</code>).</p> <p>If a field is not explicitly OPTIONAL, it can be considered REQUIRED.</p>"},{"location":"contributing/specification/#scenario","title":"Scenario","text":"<p>A Scenario is the highest-level grouping in DFIQ. A Scenario is made of one or more Facets (different  \"sides\" of an investigation), which in turn are made up of investigative Questions.</p> Field name Type Description <code>display_name</code> <code>string</code> A human readable name for the scenario. <code>description</code> <code>string</code> A description of the scenario. Markdown syntax MAY be used for rich text representation. <code>dfiq_version</code> <code>string</code> A semantic version format major.minor.patch scheme. <code>type</code> <code>string</code> Represent the type of DFIQ object. Should be <code>scenario</code> for scenarios. <code>id</code> <code>string</code> Identifier using the format defined in identifiers. <code>tags</code> <code>[string]</code> Optional. List of tags. <code>contributors</code> <code>[Object]</code> Optional. List of people who contributed to this component. <p>Example (source): <pre><code>display_name: Data Exfiltration\ntype: scenario\ndescription: &gt;\n  An employee is suspected of unauthorized copying of sensitive data (code,\n  trade secrets, etc) from internal systems to those outside of the company's\n  control.\nid: S1001\ndfiq_version: 1.0.0\ntags:\n  - Insider\n</code></pre></p>"},{"location":"contributing/specification/#facet","title":"Facet","text":"<p>Facets are used for intermediate-level grouping in DFIQ. A particular Facet can be part of multiple different Scenarios and will contain multiple Questions. A Facet breaks the larger Scenario into  smaller logical pieces, but a Facet is still too broad to answer directly; it must also be broken down (into Questions).</p> Field name Type Description <code>display_name</code> <code>string</code> A human readable name for the facet. <code>description</code> <code>string</code> Optional. A description of the facet. Markdown syntax MAY be used for rich text representation. <code>dfiq_version</code> <code>string</code> A semantic version format major.minor.patch scheme. <code>type</code> <code>string</code> Represent the type of DFIQ object. Should be <code>facet</code> for facets. <code>id</code> <code>string</code> Identifier using the format defined in identifiers. <code>tags</code> <code>[string]</code> Optional. List of tags. <code>contributors</code> <code>[string]</code> Optional. List of people who contributed to this component. <code>parent_ids</code> <code>[string]</code> List of DFIQ scenario IDs that this facet belongs to. <p>Example (source): <pre><code>display_name: Are there signs of staging data for future exfiltration?\ntype: facet\ndescription: &gt;\n  \"Staging\" refers to the collection of data of interest onto a local system,\n  as a precursor step for future exfiltration of that data. When reviewing\n  data from Questions in this Facet, look for unusual volumes of results\n  (number or size of files downloaded or sent, for example).\nid: F1008\ndfiq_version: 1.0.0\ntags:\n - TA0009\nparent_ids:\n - S1001\n</code></pre></p>"},{"location":"contributing/specification/#question","title":"Question","text":"<p>Questions are the fundamental \"building blocks\" of DFIQ. All other DFIQ components are relative to Questions:  Approaches describe how to answer the Questions, and Scenarios and Facets organize the Questions logically.  </p> <p>A Question should be specific enough that it can be readily answered, and not easily divided into multiple parts (if it can be, it likely should be multiple Questions). A single Question can be reused in multiple different Facets.</p> Field name Type Description <code>display_name</code> <code>string</code> A human readable name for the question. <code>description</code> <code>string</code> Optional. A description of the question. Markdown syntax MAY be used for rich text representation. <code>dfiq_version</code> <code>string</code> A semantic version format major.minor.patch scheme. <code>type</code> <code>string</code> Represent the type of DFIQ object. Should be <code>question</code> for questions. <code>id</code> <code>string</code> Identifier using the format defined in identifiers. <code>tags</code> <code>[string]</code> Optional. List of tags. <code>contributors</code> <code>[string]</code> Optional. List of people who contributed to this component. <code>parent_ids</code> <code>[string]</code> List of DFIQ facet IDs that this question belongs to. <p>Example (source): <pre><code>display_name: What files were downloaded using a web browser?\ntype: question\ndescription: Downloading files via a web browser is a common way to introduce\n  files to a computer. Determining what files were downloaded can be helpful \n  in variety of scenarios, ranging from malware investigations to insider cases. \nid: Q1001\ndfiq_version: 1.0.0\ntags:\n - Web Browser\nparent_ids:\n - F1008\n - F1002\n</code></pre></p>"},{"location":"contributing/specification/#approach","title":"Approach","text":"<p>Approaches are detailed explanations of how to answer a Question using a specific method, including the  required data, processing, and analysis steps. As there is often more than one way to answer a question, there can be multiple Approaches that answer a given Question using different techniques. </p> <p>Approaches are tightly linked to their Question. Whereas a Question can be a part of multiple Facets, and a Facet can be part of multiple Scenario, an Approach can only apply to a single specific Question.</p> Field name Type Description <code>display_name</code> <code>string</code> A human readable name for the approach. <code>description</code> <code>Object</code> See Approach Description schema. <code>type</code> <code>string</code> Represent the type of DFIQ object. Should be <code>approach</code> for approaches. <code>dfiq_version</code> <code>string</code> A semantic version format major.minor.patch scheme. <code>id</code> <code>string</code> Identifier using the format defined in identifiers. An Approach identifier will share the first five characters with the Question it relates to, and end with a two-digit suffix. Example: <code>Q1024.12</code>. <code>tags</code> <code>[string]</code> Optional. List of tags. <code>contributors</code> <code>[string]</code> Optional. List of people who contributed to this component. <code>view</code> <code>Object</code> The view aims to be a concise representation of how to perform this investigative approach. See the View schema."},{"location":"contributing/specification/#description","title":"Description","text":"<p>The <code>description</code> is a bit that goes before the details on how to implement the approach. It can introduce important concepts and terms. If reasonable, long form explanations of forensic concepts should be added to the ForensicsWiki, and then a link to that page added in <code>references</code> to avoid duplication.</p> Field name Type Description <code>summary</code> <code>string</code> A human readable summary for the approach. <code>details</code> <code>string</code> A description of the approach. Markdown syntax MAY be used for rich text representation. <code>references</code> <code>[string]</code> Optional. List of URLs of public references to this approach. Markdown syntax MAY be used for rich text representation. <code>references_internal</code> <code>[string]</code> Optional. List of URLs of private references to this approach. Markdown syntax MAY be used for rich text representation. <p>Example (source): <pre><code>description:\n  summary: Parse download records from web browsers' own databases.\n  details: &gt;\n    Most web browsers track file downloads (at least in non-Incognito/private\n    sessions) in local artifacts on the system. We can collect and review\n    these records. This approach is useful when you have remote access to a\n    system (via GRR for example) or a disk image.\n  references:\n    - \"[Chrome](https://forensics.wiki/google_chrome/#downloadsstart_time),\n      [Firefox](https://forensics.wiki/mozilla_firefox/#downloads), and\n      [Safari](https://forensics.wiki/apple_safari/#downloads) downloads on\n      ForensicsWiki\"\n</code></pre></p>"},{"location":"contributing/specification/#view","title":"View","text":"<p>The <code>view</code> aims to be a concise representation of how to perform this investigative approach, with some omissions. The <code>data</code> section describes the data that will need to be collected, but not how to collect it. Similarly, each object in <code>processors</code> may provide configuration or filtering information, but doesn't explain how to run the processor.</p> Field name Type Description <code>data</code> <code>[Object]</code> The data required to answer the question via this approach. <code>notes</code> <code>Object</code> A description of the approach. Markdown syntax MAY be used for rich text representation. <code>processors</code> <code>[Object]</code> Optional. List of Processor objects."},{"location":"contributing/specification/#data","title":"Data","text":"<p>This section (<code>view.data</code>) can have multiple ways describing the data needed for this approach. They should be thought of as complementary or as alternates to each other (they can be \"OR\"d together, they do not need to be \"AND\"d). Each is specified by a pair of <code>type</code> and <code>value</code>. Current <code>type</code>s are <code>artifact</code> and <code>description</code>, but more can be added as needs arise.</p> <ul> <li><code>artifact</code> corresponds to the name of a ForensicArtifact, an existing repository of machine-readable digital forensic artifacts. Specifying a value for <code>artifact</code> is preferred when the data is a host-based file/artifact, but other methods are available as well.</li> <li><code>description</code> is a string describing the data that's needed. This can be used alone to describe the data, if an <code>artifact</code> isn't available or appropriate, or in conjunction with an <code>artifact</code> to better describe it.</li> </ul> Field name Type Description <code>type</code> <code>string</code> The type of the data. Example: <code>artifact</code> for ForensicArtifact definition. <code>value</code> <code>string</code> The value of the type. Example: <code>BrowserHistory</code> (the name of the ForensicArtifact). <p>Example (source): <pre><code>data:\n  - type: artifact\n    value: BrowserHistory\n  - type: description\n    value: Collect local browser history artifacts. These are often in the\n      form of SQLite databases and JSON files in multiple directories.\n</code></pre></p>"},{"location":"contributing/specification/#notes","title":"Notes","text":"<p>The data specified often comes with certain caveats; these can often be tacit knowledge or assumed that \"everyone knows that\". This can lead to incorrect assumptions and analysis. Explicitly stating them reduces ambiguity.</p> Field name Type Description <code>covered</code> <code>[string]</code> List of strings describing what this data is covering in the context of the approach. <code>not_covered</code> <code>[string]</code> List of strings describing what this data is NOT covering in the context of the approach. <p>Example (source): <pre><code>notes:\n  covered:\n    - Chrome downloads. Beyond \"stable\" Chrome, this also includes\n      Chromium, Chrome Canary, Chrome Beta, and other Chromium-based browsers\n      (Microsoft Edge, Brave, and Opera) on Windows, macOS, and Linux\n    - Safari downloads\n    - Includes downloads from all Chrome profiles\n  not_covered:\n    - Browsers installed in non-standard paths\n    - Downloads made during Incognito sessions\n</code></pre></p>"},{"location":"contributing/specification/#processors","title":"Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data an investigator reviews. Multiple processors can be defined, as there are often multiple programs capable of doing similar processing (example: log2timeline, Magnet Axiom, and Hindsight can all process browser history artifacts and deliver similar results).</p> Field name Type Description <code>name</code> <code>string</code> Name of the processor. <code>options</code> <code>[Object]</code> Optional. Configuration options for the processor. <code>analysis</code> <code>Object</code> Optional. Analysis methods and steps."},{"location":"contributing/specification/#options","title":"Options","text":"<p>The named processor may benefit from some configuration options.</p> Field name Type Description <code>type</code> <code>string</code> Type of option. This is dependent on the type of processor. <code>value</code> <code>string</code> Value of the option. <p>Example (source): <pre><code>options:\n  - type: parsers\n    value: webhist\n</code></pre></p>"},{"location":"contributing/specification/#analysis","title":"Analysis","text":"<p>After running the processor against the <code>data</code> (possibly using the <code>options</code>), we may want to take further analysis steps to refine that information. This could take the form of filtering the data, sorting or otherwise manipulating it, or something specific to a given analysis platform (for example, Timesketch may produce a graph).</p> <p>Each object in <code>analysis</code> is an analysis method, consisting of its <code>name</code> and the analysis <code>steps</code>. Broadly speaking, each analysis method should produce similar output; the user can choose whichever method is available to them and get similar results. This will not always be the case (a Timesketch graph is different from a pandas DataFrame), but it is the intent.</p> Field name Type Description <code>name</code> <code>string</code> Name of the analysis method. <code>steps</code> <code>[Object]</code> The steps of the analysis method."},{"location":"contributing/specification/#steps","title":"Steps","text":"<p>Under each analysis method will be a sequence of one or more maps with keys <code>description</code>, <code>type</code>, and <code>value</code>. If there is more than one map, they should be processed in sequence in the analysis method (if applicable). In this way, we can describe multiple chained steps of analysis (with the <code>description</code> being a way to communicate to the user what exactly each \"step\" is doing, enabling a \"show-your-work\"-type capability).</p> Field name Type Description <code>description</code> <code>string</code> Human readable description of the analysis step. <code>type</code> <code>string</code> The type of the analysis step. <code>value</code> <code>string</code> The value of the analysis step. <p>Example (source): <pre><code>analysis:\n  - name: OpenSearch\n    steps:\n      - description: Filter the results to just file downloads\n        type: opensearch-query\n        value: data_type:(\"chrome:history:file_downloaded\" OR \"safari:downloads:entry\")\n  - name: Python Notebook\n    steps:\n      - description: Filter the results to just file downloads\n        type: pandas\n        value: query('data_type in (\"chrome:history:file_downloaded\", \"safari:downloads:entry\")')\n      - description: Not necessary, but wanted to show two steps\n        type: pandas\n        value: sort_values(by='timestamp').head(5)\n</code></pre></p> <p>Python notebooks (Jupyter, Colab, etc) have become powerful tools for security analysts. Recording the analysis steps in a way that would work in a notebook makes the analysis more accessible and easier to demonstrate.</p> <p><code>type: pandas</code> refers to pandas DataFrame methods. They allow chaining, which is very powerful and flexible. One would apply the operation in <code>value</code> by assuming the data from the previous step (either the results from <code>data</code> or the prior analysis step) was saved into a Pandas DataFrame (<code>df</code>), then applying the operation to it. For example, the first <code>pandas</code> step in the example is equivalent to: <code>df.query('data_type in (\"chrome:history:file_downloaded\", \"safari:downloads:entry\")')</code>.</p>"},{"location":"questions/","title":"Questions","text":"<p>Questions are the core of DFIQ. All other DFIQ components are relative to Questions: Approaches describe how to answer the Questions, and Scenarios and Facets organize the Questions logically. Below is an index of all the Questions that are defined as part of DFIQ.</p> <p>Some quick facts about Questions in DFIQ:</p> <ul> <li>Questions should be small enough in scope that they can be readily answered</li> <li>A single Question can be reused in multiple different Facets</li> <li>If a Question has any Approaches defined, it will render as a link to the detailed Question page</li> </ul> <p>Note</p> <p>Not all the Questions have Approaches defined; in fact, most don't at the moment. If you'd like to contribute an idea for a new Question, or a new Approach for answering an existing Question, please open an issue on GitHub.</p>"},{"location":"questions/#questions-index","title":"Questions Index","text":"ID Question Tags Approaches Q1001 What files were downloaded using a web browser? Safari Windows Edge macOS NTFS SQLite USN Journal Chrome Web Browser 3 Q1002 What USB devices were attached to a computer? 0 Q1003 What files were copied from a computer to a USB device? 0 Q1004 What screenshots were taken on a computer? 0 Q1005 What files have ever been on a computer? 0 Q1006 What files are present on a computer? 0 Q1007 What files were synced or backed-up to external services? T1567.002 0 Q1008 What programs are installed on a computer? 0 Q1009 What interactions with external cloud storage sites did the actor have using their web browser? 0 Q1010 What was printed from a computer? 0 Q1011 What files were sent or received by a chat application? 0 Q1012 What files were copied from a USB device to a computer? 0 Q1013 What files are present on a USB device? 0 Q1014 What files did the actor open on their computer? File Knowledge 0 Q1015 What syncing activities did external \"cloud storage\" applications do on a computer? 0 Q1016 What files were sent externally via email attachments? 0 Q1017 Were any files collected into a container? 0 Q1018 What process made the DNS query? DNS CrowdStrike Windows Sysmon 3 Q1019 What web browsers were running at a given time? Process Execution CrowdStrike Web Browser 1 Q1020 What pages did web browsers visit? Safari Edge SQLite Internet Explorer Chrome Web Browser Firefox 1 Q1021 What Chrome extensions are installed? Web Browser 0 Q1022 What actions did a Chrome extension perform? Chrome Browser Extension Web Browser 0 Q1023 Is a given Chrome extension associated with a given domain? Chrome T1176 0 Q1024 Was an Incognito/Private browser session used? Process Execution CrowdStrike Web Browser 1 Q1025 What external accounts has the actor used in their web browser? 0 Q1026 What files were downloaded from messaging apps? 0 Q1027 Are there any sudden changes in the number of files on a device? 0 Q1028 Was there specialized \"anti-forensic\" (or \"privacy\") software on a computer? 0 Q1029 Were any encryption programs used on a computer? 0 Q1030 Were any security or monitoring agents tampered with or disabled? 0 Q1031 How much network traffic was there to/from a machine? 0 Q1032 What actions were taken in an Incognito (or \"private\") browser session? 0 Q1033 Was shell history cleared? 0 Q1034 Was content copied from a file? 0 Q1035 Were any copies made of sensitive files? 0 Q1036 Have there been any executions of PsExec? Event Logs Prefetch Windows 2 Q1037 Have there been any executions of PsExeSrv? Event Logs Prefetch Windows 3 Q1038 Were any files sent via CLI utilities? 0 Q1039 Are there any detections of exposed service account credentials? 0 Q1040 Are there any interaction with the cloud project resources from an unknown external IP address (including Tor Exit nodes, C2 tagged addresses)? 0 Q1041 Are there any unexpected successful API calls from an unknown external IP address (including Tor Exit nodes, C2 tagged addresses)? 0 Q1042 Are there any APIs recently enabled? 0 Q1043 Are there any role bindings to cluster admin for anonymous users? 0 Q1044 Are there any unexpected resources created under the cloud project? 0 Q1045 Are there any unknown accounts created? 0 Q1046 Are there any unknown role bindings created? 0 Q1047 Are there any suspicious modifications to the cloud project firewall rules/policies? 0 Q1048 Are there any suspicious modifications to the cloud project logging configuration? 0 Q1049 Is there an unusual increase of traffic between resource in the cloud project? 0 Q1050 Are there any GCS buckets within the cloud project shared externally? 0 Q1051 Are there any signs of data within the cloud project being transferred externally? 0 Q1052 What browser extensions (non-Chrome) are installed? Web Browser 0 Q1053 What Launch Agents are configured? macOS T1543.001 0 Q1054 What Launch Daemons are configured? macOS T1543.004 0 Q1055 What Windows logon scripts are configured? T1037.001 Windows 0 Q1056 What login hooks are configured? T1037.002 macOS 0 Q1057 What network logon scripts are configured? T1037.003 Windows 0 Q1058 What domain accounts have been created? T1136.002 Windows 0 Q1059 What local accounts have been created? T1136.001 macOS Windows Linux 0 Q1060 What AT jobs are configured? T1053.002 macOS Linux 0 Q1061 What Scheduled Tasks are configured? T1053.005 Windows 0 Q1062 What cron jobs are configured? T1053.003 macOS Linux 0 Q1063 What periodic scripts are configured? macOS 0 Q1064 What systemd timers are configured? T1053.006 Linux 0 Q1065 What files are referenced in Registry \"Run\" keys? T1547.001 Windows 0 Q1066 What items are in startup folders? T1547.001 Windows 0 Q1067 What system services are installed? macOS Windows Linux 0 Q1068 When were system services last modified? macOS Windows Linux 0 Q1069 Are there any indications of dylib hijacking? macOS T1574.004 0 Q1070 Are there any indications of dylib proxying? macOS 0 Q1071 Are there any indications of dynamic linker hijacking? T1574.006 macOS Linux 0 Q1072 Did Chrome's DNS Prefetching cause a DNS query? DNS Web Browser 0 Q1073 Have there been any modifications to the \"hosts\" file? 0 Q1074 Were any system event logs cleared? Event Logs CrowdStrike Windows Linux macOS T1070.002 T1070.001 2 Q1075 Is the recipient account controlled by the sender? 0 Q1076 Were the files screenshots? 0 Q1077 Were there bulk downloads from Google Drive? 0 Q1078 Were the files copies? 0 Q1079 Is there a history of communication with the recipients? 0 Q1080 How many external recipients does the email have? 0 Q1081 Does the user have a recently provisioned host? 0 Q1082 Were any files sent via AirDrop? 0 Q1083 Were any files sent via Bluetooth? T1011.001 0 Q1084 What data was uploaded to a website via a web browser? 0 Q1085 What DNS requests have been made from a system? 0 Q1086 What web-based email messages were viewed in a web browser? 0 Q1087 Did the user access any common PaaS/SaaS services? 0 Q1088 Did the user connect to any non-Company systems using the command line? 0 Q1089 Did the user download any Citrix configuration (.ica) files? 0 Q1090 Did the user interact with any git repositories? 0"},{"location":"questions/Q1001/","title":"What files were downloaded using a web browser?","text":"<p>UUID: 8620a183-d67f-481e-a63c-d8b8dfa5e968 ID: Q1001</p> <p>Approaches to Answer</p> <ul> <li>Collect download records from local browser artifacts [Q1001.10]<ul> <li>Parse download records from web browsers' own databases.</li> <li>Tags: Web Browser SQLite Chrome Safari Edge</li> </ul> </li> <li>Detect browser downloads via file system event logs [Q1001.11]<ul> <li>File downloads by some web browsers create a specific pattern of events on the file system. We can use this to see browser downloads using file system logs (like Santa).</li> <li>Tags: Web Browser macOS</li> </ul> </li> <li>Detect browser downloads via change journal records [Q1001.12]<ul> <li>File downloads by some web browsers create a specific pattern of events on the file system. We can use this to see browser downloads using NTFS change journal (USN journal) records.</li> <li>Tags: Web Browser Windows USN Journal NTFS</li> </ul> </li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#collect-download-records-from-local-browser-artifacts","title":"Collect download records from local browser artifacts","text":"","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse download records from web browsers' own databases.</p> <p>Most web browsers track file downloads (at least in non-Incognito/private sessions) in local artifacts on the system. We can collect and review these records. This approach is useful when you have remote access to a system (via GRR for example) or a disk image.</p>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#references","title":"References","text":"<ul> <li>Chrome, Firefox, and Safari downloads on ForensicsWiki</li> <li>Web Browsers on ForensicArtifacts</li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Chrome downloads. Beyond \"stable\" Chrome, this also includes Chromium, Chrome Canary, Chrome Beta, and other Chromium-based browsers (Microsoft Edge, Brave, and Opera) on Windows, macOS, and Linux</li> <li>Safari downloads</li> <li>Includes downloads from all Chrome profiles</li> </ul> <p>Not Covered</p> <ul> <li>Firefox downloads</li> <li>Downloads on any other browsers</li> <li>Browsers installed in non-standard paths</li> <li>Downloads made during Incognito sessions</li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Collect local browser history artifacts. These are often in the form of SQLite databases and JSON files in multiple directories. Type ForensicArtifact Value BrowserHistory (view on GitHub)","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> PlasoHindsight <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers webhist\n</code></pre> <p>More information on Hindsight.</p> <p>Recommended options:</p> <pre><code> --format jsonl\n</code></pre>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to just file downloads</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:(\"chrome:history:file_downloaded\" OR \"safari:downloads:entry\")\n</code></pre> </li> </ol> <p>Python Notebook</p> <ol> <li>Filter the results to just file downloads</li> <li> <p>Python code:</p> <pre><code>df.query('data_type in (\"chrome:history:file_downloaded\", \"safari:downloads:entry\")')\n</code></pre> </li> </ol>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Hindsight's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li> <p>Filter the results to just file downloads. Hindsight only supports Chromium-based browsers (including Microsoft Edge) and not Firefox or Safari.</p> </li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"chrome:history:file_downloaded\"\n</code></pre> </li> </ol> <p>Python Notebook</p> <ol> <li> <p>Filter the results to just file downloads. Hindsight only supports Chromium-based browsers (including Microsoft Edge) and not Firefox or Safari.</p> </li> <li> <p>Python code:</p> <pre><code>df.query('data_type == \"chrome:history:file_downloaded\"')\n</code></pre> </li> </ol>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#detect-browser-downloads-via-file-system-event-logs","title":"Detect browser downloads via file system event logs","text":"","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#explanation_1","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>File downloads by some web browsers create a specific pattern of events on the file system. We can use this to see browser downloads using file system logs (like Santa).</p> <p>Chrome downloads on macOS create a specific pattern of file system events:</p> <ol> <li>Download starts with a <code>WRITE</code> event to a temp file named like     <code>.com.google.Chrome.avXx0U</code> (the suffix looks to be 6 letters/numbers). </li> <li>That .com.google.Chrome... temp file might be <code>RENAME</code>d to <code>Unconfirmed [6      digits].crdownload</code>. </li> <li>If [2] <code>Unconfirmed...crdownload</code> <code>RENAME</code> didn't happen, the .com.google.     temp file is renamed to the eventual filename (with extension) with     <code>.crdownload</code> appended at the end (like <code>cat.jpg.crdownload</code>). In either     case ([2] or [3]), at this point we have a file ending in .crdownload.</li> <li>Once the download completes, the <code>.crdownload</code> suffix is removed via a     <code>RENAME</code> event, leaving the downloaded file with its final name.</li> </ol> <p>Since [4] above captures the key information about the file download, we can search file system logs for it.</p>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#notes_1","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Chrome downloads on macOS (given that Santa was installed and logging enabled)</li> </ul> <p>Not Covered</p> <ul> <li>All other browsers</li> <li>Downloads from other Chromium/Chrome-based browsers might be collected via this method, but testing is necessary to confirm.</li> <li>Downloads that occurred on macOS with Santa, but during a time period for which there are no Santa logs (out of retention or Santa was disabled).</li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#data_1","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Santa logs stored on the local disk; they may also be centralized off-system, but this artifact does not include those. Type ForensicArtifact Value SantaLogs (view on GitHub)","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#processors_1","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers santa\n</code></pre>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#analysis_2","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to file system rename events where the original file name ended with <code>.crdownload</code>.</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"santa:file_system_event\" action:RENAME file_path:\"*\\.crdownload\"\n</code></pre> </li> </ol>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#detect-browser-downloads-via-change-journal-records","title":"Detect browser downloads via change journal records","text":"","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#explanation_2","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>File downloads by some web browsers create a specific pattern of events on the file system. We can use this to see browser downloads using NTFS change journal (USN journal) records.</p> <p>Chrome downloads on Windows create a specific pattern of events on the file system:</p> <ol> <li>**Download starts with a <code>FILE CREATE</code> event to <code>.tmp</code> file; older Chrome versions     have been observed creating four character file names (like <code>7DEE.tmp</code>)     while newer versions use file names consistent with Version 4 UUIDs     (like <code>183011a0-f96c-4c98-b71b-ab8754fb0e0e.tmp</code>).</li> <li>That <code>.tmp</code> file might be <code>RENAME</code>d to <code>Unconfirmed [6 digits].crdownload</code>. </li> <li>If [2] <code>Unconfirmed...crdownload</code> <code>RENAME</code> didn't happen, the <code>.tmp</code> file is     renamed to the eventual filename (with extension) with <code>.crdownload</code> appended     at the end (like <code>cat.jpg.crdownload</code>). In either case ([2] or [3]), at     this point we have a file ending in .crdownload.</li> <li>Once the download completes, the <code>.crdownload</code> suffix is removed via a     <code>USN_REASON_RENAME_OLD_NAME</code> event, leaving the downloaded file with its final name.</li> </ol> <p>Since [4] above captures the key information about the file download, we can search change journal records for it.</p>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#references_1","title":"References","text":"<ul> <li>Change Journals</li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#notes_2","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Chrome downloads to an NTFS volume</li> </ul> <p>Not Covered</p> <ul> <li>All other browsers.</li> <li>Downloads from other Chromium/Chrome-based browsers might be collected via this method, but testing is necessary to confirm.</li> <li>Downloads on file systems other than NTFS.</li> <li>Downloads that would be covered, but happened long enough ago that the USN Journal records that would show it have been deleted.</li> </ul>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#data_2","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description The NTFS $UsnJnrl file system metadata file. This ForensicArtifact definition does not include the $J alternate data stream, but many tools collect it anyway. Type ForensicArtifact Value NTFSUSNJournal (view on GitHub)","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#processors_2","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers usnjrnl\n</code></pre>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1001/#analysis_3","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to file system rename events where the original file name ended with <code>.crdownload</code>.</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"fs:ntfs:usn_change\" filename:crdownload \"USN_REASON_RENAME_OLD_NAME\"\n</code></pre> </li> <li> <p>Select and search for the <code>file_reference</code> value for an event of interest from the previous query. There should be one with the same timestamp as your previous event and its <code>filename</code> value is the download's final name.</p> </li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"fs:ntfs:usn_change\" {file_reference value} \"USN_REASON_RENAME_NEW_NAME\"\n</code></pre> </li> </ol>","tags":["Chrome","Edge","macOS","NTFS","Safari","SQLite","USN Journal","Web Browser","Windows"]},{"location":"questions/Q1018/","title":"What process made the DNS query?","text":"<p>UUID: 9f9d6a06-d4de-4abd-a5b7-0ac9964cf707 ID: Q1018</p> <p>Approaches to Answer</p> <ul> <li>Use Crowdstrike \"Bulk Domains\" to link source processes to DNS queries [Q1018.10]<ul> <li>CrowdStrike records the source process ID (ContextProcessId) for DNSRequest event.</li> <li>Tags: CrowdStrike DNS</li> </ul> </li> <li>Use Crowdstrike event search to link source processes to DNS queries [Q1018.11]<ul> <li>CrowdStrike records the source process ID (ContextProcessId) for DNSRequest event.</li> <li>Tags: CrowdStrike DNS</li> </ul> </li> <li>Use Sysmon (Event ID 22) to link source processes to DNS queries [Q1018.12]<ul> <li>Sysmon Event ID 22 DnsQuery stores source process ID</li> <li>Tags: Sysmon DNS Windows</li> </ul> </li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#use-crowdstrike-bulk-domains-to-link-source-processes-to-dns-queries","title":"Use Crowdstrike \"Bulk Domains\" to link source processes to DNS queries","text":"","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>CrowdStrike records the source process ID (ContextProcessId) for DNSRequest event.</p> <p>Crowdstrike is a detection platform, not a logging platform, so not all DNS requests are logged. Content Filter needs to be enabled to capture DNS request queries.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#references","title":"References","text":"<ul> <li>https://www.crowdstrike.com/blog/hunt-threat-activity-falcon-host-endpoint-protection/bulk-domain-search-results/</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Mac, Linux, and Windows hosts with a CrowdStrike Falcon agent</li> </ul> <p>Not Covered</p> <ul> <li>Hosts with the Falcon agent, but where the Content Filter is not enabled</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> <ul> <li>CrowdStrike: DnsRequest</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Crowdstrike Investigate (Ui) <p>More information on Crowdstrike Investigate (Ui).</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Crowdstrike Investigate (Ui)'s output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Manual</p> <ol> <li>UI steps in Investigate Bulk domains</li> <li>Type: GUI</li> <li>Value: In the second table, <code>Process that looked up specified Domain(s)</code> the columns  <code>PID</code>, <code>Process ID</code>, and <code>File Name</code> give the source process information for the  DNS query.</li> </ol>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#use-crowdstrike-event-search-to-link-source-processes-to-dns-queries","title":"Use Crowdstrike event search to link source processes to DNS queries","text":"","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#explanation_1","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>CrowdStrike records the source process ID (ContextProcessId) for DNSRequest event.</p> <p>Crowdstrike is a detection platform, not a logging platform, so not all DNS requests are logged. Content Filter needs to be enabled to capture DNS request queries.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#references_1","title":"References","text":"<ul> <li>https://www.crowdstrike.com/blog/hunt-threat-activity-falcon-host-endpoint-protection/bulk-domain-search-results/</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#notes_1","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Mac, Linux, and Windows hosts with a CrowdStrike Falcon agent</li> </ul> <p>Not Covered</p> <ul> <li>Hosts with the Falcon agent, but where the Content Filter is not enabled</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#data_1","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> <ul> <li>CrowdStrike: DnsRequest</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#processors_1","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Splunk <p>More information on Splunk.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Splunk's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Splunk-Query</p> <ol> <li>Query joining DNS Request events and executions gives the source for each DNS query</li> <li>Type: splunk-query</li> <li>Value: ComputerName=\"{hostname}\" event_simpleName=ProcessRollup* | rename TargetProcessId_decimal as ContextProcessId_decimal | join ContextProcessId_decimal [search ComputerName=\"{hostname}\" event_simpleName=DnsRequest | fields ContextProcessId_decimal, DomainName] | table _time, DomainName, ImageFileName</li> </ol>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#use-sysmon-event-id-22-to-link-source-processes-to-dns-queries","title":"Use Sysmon (Event ID 22) to link source processes to DNS queries","text":"","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#explanation_2","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Sysmon Event ID 22 DnsQuery stores source process ID</p> <p>DNS Query, event ID 22, records a DNS query being issued by a specific host and the originating process.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#references_2","title":"References","text":"<ul> <li>https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90022</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#notes_2","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Windows</li> </ul> <p>Not Covered</p> <ul> <li>Windows hosts without Sysmon installed</li> </ul>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#data_2","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Type ForensicArtifact Value WindowsXMLEventLogSysmon (view on GitHub)","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#processors_2","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> SplunkPlaso <p>More information on Splunk.</p> <p>More information on Plaso.</p>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#analysis_2","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Splunk's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Splunk-Query</p> <ol> <li>Query for Sysmon Event ID 22 and extracting the parent process ID and path.</li> <li>Type: splunk-query</li> <li>Value: source=\"xmlwineventlog:microsoft-windows-sysmon/operational\" EventCode=22 | table _time, host, process_id, process_path</li> </ol>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1018/#analysis_3","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Query for Sysmon Event ID 22 events</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:evtx:record\" source_name:\"Microsoft-Windows-Sysmon\" event_identifier:22\n</code></pre> </li> <li> <p>Determine the source process in relevant event(s)</p> </li> <li>Type: manual</li> <li>Value: Plaso (as of v20230717) doesn't parse the <code>xml_string</code> into attributes. Examine the <code>xml_string</code>; the value after <code>&lt;Data Name=\"Image\"&gt;</code> is the process that made the DNS query.</li> </ol> <p>Python Notebook</p> <ol> <li>Query for Sysmon Event ID 22 events</li> <li> <p>Python code:</p> <pre><code>df.df.query('data_type == \"windows:evtx:record\" and source_name == \"Microsoft-Windows-Sysmon\" and event_identifier == 22')\n</code></pre> </li> <li> <p>Extract <code>Image</code> attribute</p> </li> <li> <p>Python code:</p> <pre><code>df.df['process'] = df['xml_string'].str.extract(r'&lt;Data Name=\"Image\"&gt;(.*?)&lt;/Data&gt;')\n</code></pre> </li> <li> <p>Extract <code>QueryName</code> attribute</p> </li> <li> <p>Python code:</p> <pre><code>df.df['query'] = df['xml_string'].str.extract(r'&lt;Data Name=\"QueryName\"&gt;(.*?)&lt;/Data&gt;')\n</code></pre> </li> <li> <p>Filter down to DNS query of interest</p> </li> <li> <p>Python code:</p> <pre><code>df.df[df.query.str.contains('&lt;domain&gt;')]\n</code></pre> </li> </ol>","tags":["CrowdStrike","DNS","Sysmon","Windows"]},{"location":"questions/Q1019/","title":"What web browsers were running at a given time?","text":"<p>UUID: ee3ccd42-9b45-4071-8a8d-c11bf00ddd0f ID: Q1019</p> <p>Approaches to Answer</p> <ul> <li>Collect process executions in Crowdstrike event search [Q1019.10]<ul> <li>CrowdStrike records process executions in ProcessRollup event.</li> <li>Tags: CrowdStrike Process Execution</li> </ul> </li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#collect-process-executions-in-crowdstrike-event-search","title":"Collect process executions in Crowdstrike event search","text":"","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>CrowdStrike records process executions in ProcessRollup event.</p> <p>CrowdStrike is a detection platform, not a logging platform, so not all ProcessRollup events might be logged.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#references","title":"References","text":"<ul> <li>https://www.crowdstrike.com/blog/understanding-indicators-attack-ioas-power-event-stream-processing-crowdstrike-falcon/</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Mac, Linux and Windows systems with the Falcon Agent</li> <li>Chrome, Firefox, Safari, and Edge web browsers</li> </ul> <p>Not Covered</p> <ul> <li>Other browsers (including Chromium)</li> <li>One of those four browsers, but have had their process name changed</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> <ul> <li>CrowdStrike: ProcessRollup</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Splunk <p>More information on Splunk.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1019/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Splunk's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Splunk-Query</p> <ol> <li>Query filtering the known browsers in execution event logs.</li> <li>Type: splunk-query</li> <li>Value: ComputerName=\"{hostname}\" event_simpleName=ProcessRollup* ImageFileName IN (\"chrome\", \"firefox\", \"safari\", \"edge\") | table _time, CommandLine, ImageFileName</li> </ol>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1020/","title":"What pages did web browsers visit?","text":"<p>UUID: e6fe3320-7051-4c0e-9d6e-61ee44b2b116 ID: Q1020</p> <p>Approaches to Answer</p> <ul> <li>Collect URL visit records from local browser artifacts [Q1020.10]<ul> <li>Parse URL visit records from web browsers' own databases.</li> <li>Tags: Web Browser SQLite Chrome Safari Firefox Edge Internet Explorer</li> </ul> </li> </ul>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#collect-url-visit-records-from-local-browser-artifacts","title":"Collect URL visit records from local browser artifacts","text":"","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse URL visit records from web browsers' own databases.</p> <p>Most web browsers track URL visits (at least in non-Incognito/private sessions) in local artifacts on the system. We can collect and review these records. This approach is useful when you have remote access to a system (via GRR for example) or a disk image.</p>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#references","title":"References","text":"<ul> <li>Chrome, Firefox, and Safari History on ForensicsWiki</li> <li>Web Browsers on ForensicArtifacts</li> </ul>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Chrome URL visits. Beyond \"stable\" Chrome, this also includes Chromium, Chrome Canary, Chrome Beta, and other Chromium-based browsers (Microsoft Edge, Brave, and Opera) on Windows, macOS, and Linux</li> <li>Includes URL visits from all Chrome profiles</li> <li>Firefox URL visits</li> <li>Safari URL visits on Windows and macOS</li> <li>Internet Explorer (4 - 10) URL visits</li> </ul> <p>Not Covered</p> <ul> <li>Other Chromium-based browsers not specified above</li> <li>Browsers installed in non-standard paths</li> <li>Visits made in Incognito/Private sessions</li> </ul>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Collect local browser history artifacts. These are often in the form of SQLite databases and JSON files in multiple directories. Type ForensicArtifact Value BrowserHistory (view on GitHub)","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> PlasoHindsight <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers webhist\n</code></pre> <p>More information on Hindsight.</p> <p>Recommended options:</p> <pre><code> --format jsonl\n</code></pre>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to just URL page visits</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:(\"chrome:history:page_visited\" OR \"firefox:places:page_visited\" OR \"safari:history:visit_sqlite\")\n</code></pre> </li> </ol> <p>Python Notebook</p> <ol> <li>Filter the results to just URL page visits</li> <li> <p>Python code:</p> <pre><code>df.query('data_type in (\"chrome:history:page_visited\", \"firefox:places:page_visited\", \"safari:history:visit_sqlite\")')\n</code></pre> </li> </ol>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1020/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Hindsight's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li> <p>Filter the results to just URL page visits. Hindsight only supports Chromium-based browsers (including Microsoft Edge) and not Firefox or Safari.</p> </li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"chrome:history:page_visited\"\n</code></pre> </li> </ol> <p>Python Notebook</p> <ol> <li> <p>Filter the results to just URL page visits. Hindsight only supports Chromium-based browsers (including Microsoft Edge) and not Firefox or Safari.</p> </li> <li> <p>Python code:</p> <pre><code>df.query('data_type == \"chrome:history:page_visited\"')\n</code></pre> </li> </ol>","tags":["Chrome","Edge","Firefox","Internet Explorer","Safari","SQLite","Web Browser"]},{"location":"questions/Q1024/","title":"Was an Incognito/Private browser session used?","text":"<p>UUID: 74753f61-48e7-4f61-9357-018589fdfa5b ID: Q1024</p> <p>Approaches to Answer</p> <ul> <li>Search CrowdStrike logs for Incognito Chrome processes [Q1024.10]<ul> <li>CrowdStrike records the source process ID (ContextProcessId) for ProcessRollup events.</li> <li>Tags: CrowdStrike Process Execution Web Browser</li> </ul> </li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#search-crowdstrike-logs-for-incognito-chrome-processes","title":"Search CrowdStrike logs for Incognito Chrome processes","text":"","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>CrowdStrike records the source process ID (ContextProcessId) for ProcessRollup events.</p> <p>Crowdstrike is a detection platform, not a logging platform, so not all executions are logged. We cannot always connect a running browser process with observed DNS requests. When we do see DNS requests coming from a browser process, yet we don't see browsing history, there are several possible explanations, including browser extensions or private browsing.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#references","title":"References","text":"<ul> <li>https://www.crowdstrike.com/blog/tech-center/hunt-threat-activity-falcon-endpoint-protection/</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Chrome on Mac, Linux, and Windows hosts with a CrowdStrike Falcon agent</li> </ul> <p>Not Covered</p> <ul> <li>Chrome instances with a renamed process</li> <li>Other Chromium-based browsers</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> <ul> <li>CrowdStrike: ProcessRollup</li> </ul>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Splunk <p>More information on Splunk.</p>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1024/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Splunk's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Splunk-Query</p> <ol> <li>Query searching for browser processes executed in private mode</li> <li>Type: splunk-query</li> <li>Value: ComputerName=\"{hostname}\" event_simpleName=ProcessRollup* CommandLine IN (\"chrome\") CommandLine IN (disable-databases) | table _time, DomainName, CommandLine</li> </ol>","tags":["CrowdStrike","Process Execution","Web Browser"]},{"location":"questions/Q1036/","title":"Have there been any executions of PsExec?","text":"<p>UUID: b557f2d1-ecba-4660-992e-2d714398499f ID: Q1036</p> <p>Description: PsExec is a command-line tool that allows you to execute commands on remote computers. It is part of the Sysinternals suite of tools, which are a collection of free and open-source utilities for Windows system administration.  It works by establishing a remote connection to the target computer and then executing the specified command. The command can be anything that you would normally run on a local computer, such as a batch file, a PowerShell script, or a simple command-line instruction.</p> <p>Approaches to Answer</p> <ul> <li>Examine Windows Prefetch for evidence of PsExec usage [Q1036.10]<ul> <li>Parse Windows Prefetch files and look for PsExec.</li> <li>Tags: Windows Prefetch</li> </ul> </li> <li>Examine Windows Event Logs for PsExec executions [Q1036.11]<ul> <li>Parse the Windows Security Event Log and look for PsExec processes being created.</li> <li>Tags: Windows Event Logs</li> </ul> </li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#examine-windows-prefetch-for-evidence-of-psexec-usage","title":"Examine Windows Prefetch for evidence of PsExec usage","text":"","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse Windows Prefetch files and look for PsExec.</p> <p>Windows Prefetch files are designed to speed up application start times. To do this, they store information about recently launched applications, including the file name of the executable and the number of times it has been run. </p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#references","title":"References","text":"<ul> <li>Prefetch on the ForensicsWiki</li> <li>PsExec on MITRE ATT&amp;CK</li> <li>Detecting PsExec Usage by 13Cubed</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Executions of PsExec on Windows systems with Prefetch enabled.</li> </ul> <p>Not Covered</p> <ul> <li>Systems where the Prefetch service has been disabled.</li> <li>There is a maximum number of <code>.pf</code> allowed by Windows (the number varies by Windows version). If too many other Prefetch files were created, the PsExec Prefetch file may have been deleted, and thus will not be parsed.</li> <li>Instances when the PsExec executable has been renamed.</li> <li>Non-Windows systems, as the Prefetch service is Windows-only.</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Files used by the Windows Prefetch service. Type ForensicArtifact Value WindowsPrefetchFiles (view on GitHub)","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers prefetch\n</code></pre>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to just Prefetch files for psexec.exe</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:prefetch:execution\" AND executable:psexec\\.exe\n</code></pre> </li> </ol>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#examine-windows-event-logs-for-psexec-executions","title":"Examine Windows Event Logs for PsExec executions","text":"","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#explanation_1","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse the Windows Security Event Log and look for PsExec processes being created.</p> <p>Windows systems can be set to log new process creation events to the Security event log. The logs contain the new process name, process ID, parent process name, process creation time, and many more useful fields.</p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#references_1","title":"References","text":"<ul> <li>4688(S): A new process has been created</li> <li>PsExec on MITRE ATT&amp;CK</li> <li>Detecting PsExec Usage by 13Cubed</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#notes_1","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Executions of PsExec on Windows systems with logging enabled.</li> </ul> <p>Not Covered</p> <ul> <li>Many factors can impact log retention; if the event log containing the relevant event has been deleted, it won't be found by this approach.</li> <li>Instances when the PsExec executable has been renamed.</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#data_1","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Windows Event Log files Type ForensicArtifact Value WindowsEventLogs (view on GitHub)","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#processors_1","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers winevtx\n</code></pre>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1036/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to Process Creation events containing \"psexec.exe\"</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:evtx:record\" event_identifier:4688 source_name:Microsoft-Windows-Security-Auditing xml_string:\"psexec.exe\"\n</code></pre> </li> </ol>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/","title":"Have there been any executions of PsExeSrv?","text":"<p>UUID: 4c06449b-33bb-414b-a877-d902710fbd3a ID: Q1037</p> <p>Description: PsExec is a command-line tool that allows you to execute commands on remote computers. It is part of the Sysinternals suite of tools, which are a collection of free and open-source utilities for Windows system administration.  It works by establishing a remote connection to the target computer and then executing the specified command. In order to do this, it copies an executable to the target system and installs a service to run that executable.</p> <p>Approaches to Answer</p> <ul> <li>Examine Windows Prefetch for evidence of PsExeSvc [Q1037.10]<ul> <li>Parse Windows Prefetch files and look for PsExeSvc.</li> <li>Tags: Windows Prefetch</li> </ul> </li> <li>Examine Windows Event Logs for PsExeSvc executions [Q1037.11]<ul> <li>Parse the Windows Security Event Log and look for PsExeSvc processes being created.</li> <li>Tags: Windows Event Logs</li> </ul> </li> <li>Examine Windows Event Logs for PsExeSvc Service Installations [Q1037.12]<ul> <li>Parse the Windows Security Event Log and look for the PsExeSvc service being installed.</li> <li>Tags: Windows Event Logs</li> </ul> </li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#examine-windows-prefetch-for-evidence-of-psexesvc","title":"Examine Windows Prefetch for evidence of PsExeSvc","text":"","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse Windows Prefetch files and look for PsExeSvc.</p> <p>Windows Prefetch files are designed to speed up application start times. To do this, they store information about recently launched applications, including the file name of the executable and the number of times it has been run. </p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#references","title":"References","text":"<ul> <li>Prefetch on the ForensicsWiki</li> <li>PsExec on MITRE ATT&amp;CK</li> <li>Detecting PsExec Usage by 13Cubed</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Executions of PsExeSvc on Windows systems with Prefetch enabled.</li> </ul> <p>Not Covered</p> <ul> <li>Systems where the Prefetch service has been disabled.</li> <li>There is a maximum number of <code>.pf</code> allowed by Windows (the number varies by Windows version). If too many other Prefetch files were created, the PsExec Prefetch file may have been deleted, and thus will not be parsed.</li> <li>Instances when the PsExeSvc executable has been renamed.</li> <li>Non-Windows systems, as the Prefetch service is Windows-only.</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Files used by the Windows Prefetch service. Type ForensicArtifact Value WindowsPrefetchFiles (view on GitHub)","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers prefetch\n</code></pre>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to just Prefetch files for psexesvc.exe</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:prefetch:execution\" AND executable:psexesvc\\.exe\n</code></pre> </li> </ol>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#examine-windows-event-logs-for-psexesvc-executions","title":"Examine Windows Event Logs for PsExeSvc executions","text":"","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#explanation_1","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse the Windows Security Event Log and look for PsExeSvc processes being created.</p> <p>Windows systems can be set to log new process creation events to the Security event log. The logs contain the new process name, process ID, parent process name, process creation time, and many more useful fields.</p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#references_1","title":"References","text":"<ul> <li>4688(S): A new process has been created</li> <li>PsExec on MITRE ATT&amp;CK</li> <li>Detecting PsExec Usage by 13Cubed</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#notes_1","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Executions of PsExeSvc on Windows systems with logging enabled.</li> </ul> <p>Not Covered</p> <ul> <li>Many factors can impact log retention; if the event log containing the relevant event has been deleted, it won't be found by this approach.</li> <li>Instances when the PsExeSvc executable has been renamed.</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#data_1","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Windows Event Log files Type ForensicArtifact Value WindowsEventLogs (view on GitHub)","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#processors_1","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers winevtx\n</code></pre>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to Process Creation events containing \"psexesvc.exe\"</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:evtx:record\" event_identifier:4688 source_name:Microsoft-Windows-Security-Auditing xml_string:\"psexesvc.exe\"\n</code></pre> </li> </ol>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#examine-windows-event-logs-for-psexesvc-service-installations","title":"Examine Windows Event Logs for PsExeSvc Service Installations","text":"","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#explanation_2","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse the Windows Security Event Log and look for the PsExeSvc service being installed.</p> <p>Windows systems can be set to log new service installations to the System event log. The logs contain the new service name, service file name, and more. When used to access a remote system, PsExec installs a service (by default named <code>PSEXESVC</code>) on the target system.</p>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#references_2","title":"References","text":"<ul> <li>4688(S): A new process has been created</li> <li>PsExec on MITRE ATT&amp;CK</li> <li>Detecting PsExec Usage by 13Cubed</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#notes_2","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Installations of the PsExeSvc Service on Windows systems with logging enabled.</li> </ul> <p>Not Covered</p> <ul> <li>Many factors can impact log retention; if the event log containing the relevant event has been deleted, it won't be found by this approach.</li> <li>Instances when the PsExeSvc service has been renamed.</li> </ul>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#data_2","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Windows Event Log files Type ForensicArtifact Value WindowsEventLogs (view on GitHub)","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#processors_2","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers winevtx\n</code></pre>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1037/#analysis_2","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to Service Install events for <code>PSEXESVC</code></li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:evtx:record\" event_identifier:7045 source_name:\"Service Control Manager\" xml_string:\"Name=\\\"ServiceName\\\"&gt;PSEXESVC\"\n</code></pre> </li> </ol>","tags":["Event Logs","Prefetch","Windows"]},{"location":"questions/Q1074/","title":"Were any system event logs cleared?","text":"<p>UUID: b85d4036-8c25-49c1-ab1a-04a45c57bf5a ID: Q1074</p> <p>Approaches to Answer</p> <ul> <li>Search CrowdStrike logs for indicator removal on host [Q1074.10]<ul> <li>CrowdStrike has built-in detections for \"indicator removal on host\" events.</li> <li>Tags: CrowdStrike Linux Windows macOS</li> </ul> </li> <li>Examine Windows Event Logs for Audit Log cleared [Q1074.11]<ul> <li>Parse the Windows Security Event Log and look for \"the audit log was cleared\" event.</li> <li>Tags: Windows Event Logs</li> </ul> </li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#approaches","title":"Approaches","text":"<p>Note</p> <p>There are often multiple ways to approach answering a question. This section explains the approaches considered, how they work, and any benefits or drawbacks to each. All these approaches have different pros and cons. They can be used individually or in conjunction.</p>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#search-crowdstrike-logs-for-indicator-removal-on-host","title":"Search CrowdStrike logs for indicator removal on host","text":"","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#explanation","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>CrowdStrike has built-in detections for \"indicator removal on host\" events.</p> <p>Clearance/deletion of system logs would be recorded in CrowdStrike as a part of their \"indicator removal on host\" detections.</p>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#references","title":"References","text":"<ul> <li>https://www.crowdstrike.com/blog/tech-center/hunt-threat-activity-falcon-endpoint-protection/</li> <li>Indicator Removal on MITRE ATT&amp;CK</li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#notes","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>CrowdStrike's built-in detection for \"indicator removal on host\" events.</li> </ul> <p>Not Covered</p> <ul> <li>CrowdStrike may not have all log clear/delete events as part of this detection.</li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#data","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> <ul> <li>CrowdStrike: PlatformEvents</li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#processors","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Splunk <p>More information on Splunk.</p>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#analysis","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Splunk's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>Splunk-Query</p> <ol> <li>Query searching for indicator removal on host events.</li> <li>Type: splunk-query</li> <li>Value: ComputerName=\"{hostname}\" Technique=\"Indicator Removal on Host\"</li> </ol>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#examine-windows-event-logs-for-audit-log-cleared","title":"Examine Windows Event Logs for Audit Log cleared","text":"","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#explanation_1","title":"\ud83d\uddc2\ufe0f Explanation","text":"<p>Parse the Windows Security Event Log and look for \"the audit log was cleared\" event.</p> <p>On Windows systems, log clearance events for Security event log will be logged with event ID 1102. The logs contain the actor account name, domain name, logon id fields.</p>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#references_1","title":"References","text":"<ul> <li>1102(S): The audit log was cleared.</li> <li>Indicator Removal: Clear Windows Event Logs on MITRE ATT&amp;CK</li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#notes_1","title":"\ud83d\udcdd Notes","text":"<p>Each approach comes with certain caveats or limitations. These can often be tacit knowledge or assumed that \"everyone knows that\" (even though they don't). This can lead to incorrect assumptions and analysis. Explicitly stating what is covered and not covered by the approach reduces ambiguity.</p> <p>Covered</p> <ul> <li>Security event log clearance events on Windows systems.</li> </ul> <p>Not Covered</p> <ul> <li>If the log is deleted or otherwise altered, this event may not be logged.</li> <li>Only applies to Windows Security audit logs.</li> </ul>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#data_1","title":"\ud83d\udcbe Data","text":"<p>The following data source(s) are needed for this approach to the question.</p> Description Windows Event Log files Type ForensicArtifact Value WindowsEventLogs (view on GitHub)","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#processors_1","title":"\u2699\ufe0f Processors","text":"<p>A processor is what takes the data collected and processes it in some way to produce structured data for an investigator to review. Multiple processor options can be defined, as there are often multiple programs capable of doing similar processing. Plaso is an example of a processor (it processes raw artifacts into a timeline). After the data is processed, additional analysis steps may be needed to answer the question.</p> <p>The following processors can process the raw data specified above. Explicit instructions on how to run the processor are not included here, but any relevant configuration options are.</p> Plaso <p>More information on Plaso.</p> <p>Recommended options:</p> <pre><code> --parsers winevtx\n</code></pre>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"questions/Q1074/#analysis_1","title":"\ud83d\udcca Analysis","text":"<p>After processing the raw data, further analysis steps are necessary to answer the question. After loading Plaso's output into one of these analysis platforms, use the following steps to refine the data to answer the question.</p> <p>OpenSearch</p> <ol> <li>Filter the results to events containing audit log clearance.</li> <li> <p>OpenSearch query:</p> <pre><code>data_type:\"windows:evtx:record\" event_identifier:1102 source_name:\"Microsoft-Windows-Security-Auditing\"\n</code></pre> </li> </ol>","tags":["CrowdStrike","Event Logs","Linux","macOS","T1070.001","T1070.002","Windows"]},{"location":"scenarios/","title":"Scenarios","text":"<p>A Scenario is a starting place for a particular type of investigation. While each case is unique,  many have common aspects and can be roughly grouped together. </p> <p>A Scenario is the highest-level grouping in DFIQ. A Scenario is made of one or more Facets  (different \"sides\" of an investigation), which in turn are made up of investigative Questions.</p>"},{"location":"scenarios/S1001/","title":"Data Exfiltration","text":"<p>UUID: aba6b02b-2ee7-49ab-9cbe-20b7259d4661 ID: S1001</p> <p>Description: An employee is suspected of unauthorized copying of sensitive data (code, trade secrets, etc) from internal systems to those outside of the company's control.</p>"},{"location":"scenarios/S1001/#are-there-any-indications-of-anti-forensic-efforts-f1007","title":"Are there any indications of anti-forensic efforts? F1007","text":"<ul> <li>Q1024 \u00a0Was an Incognito/Private browser session used?</li> <li>Q1028 \u00a0Was there specialized \"anti-forensic\" (or \"privacy\") software on a computer?</li> <li>Q1029 \u00a0Were any encryption programs used on a computer?</li> <li>Q1030 \u00a0Were any security or monitoring agents tampered with or disabled?</li> <li>Q1032 \u00a0What actions were taken in an Incognito (or \"private\") browser session?</li> <li>Q1033 \u00a0Was shell history cleared?</li> <li>Q1074 \u00a0Were any system event logs cleared?</li> </ul>"},{"location":"scenarios/S1001/#are-there-signs-of-staging-data-for-future-exfiltration-f1008","title":"Are there signs of staging data for future exfiltration? F1008","text":"<p>\"Staging\" refers to the collection of data of interest onto a local system, as a precursor step for future exfiltration of that data. When reviewing data from Questions in this Facet, look for unusual volumes of results (number or size of files downloaded or sent, for example).</p> <ul> <li>Q1001 \u00a0What files were downloaded using a web browser?</li> <li>Q1004 \u00a0What screenshots were taken on a computer?</li> <li>Q1005 \u00a0What files have ever been on a computer?</li> <li>Q1006 \u00a0What files are present on a computer?</li> <li>Q1017 \u00a0Were any files collected into a container?</li> <li>Q1034 \u00a0Was content copied from a file?</li> <li>Q1035 \u00a0Were any copies made of sensitive files?</li> <li>Q1077 \u00a0Were there bulk downloads from Google Drive?</li> </ul>"},{"location":"scenarios/S1001/#was-any-sensitive-data-sent-externally-via-email-f1009","title":"Was any sensitive data sent externally via email? F1009","text":"<ul> <li>Q1016 \u00a0What files were sent externally via email attachments?</li> <li>Q1075 \u00a0Is the recipient account controlled by the sender?</li> <li>Q1076 \u00a0Were the files screenshots?</li> <li>Q1078 \u00a0Were the files copies?</li> <li>Q1079 \u00a0Is there a history of communication with the recipients?</li> <li>Q1080 \u00a0How many external recipients does the email have?</li> </ul>"},{"location":"scenarios/S1001/#was-any-sensitive-data-exfiltrated-via-a-physical-medium-f1010","title":"Was any sensitive data exfiltrated via a physical medium? F1010","text":"<ul> <li>Q1003 \u00a0What files were copied from a computer to a USB device?</li> <li>Q1010 \u00a0What was printed from a computer?</li> </ul>"},{"location":"scenarios/S1001/#was-any-sensitive-data-exfiltrated-via-a-web-service-f1011","title":"Was any sensitive data exfiltrated via a web service? F1011","text":"<ul> <li>Q1007 \u00a0What files were synced or backed-up to external services?</li> <li>Q1009 \u00a0What interactions with external cloud storage sites did the actor have using their web browser?</li> <li>Q1011 \u00a0What files were sent or received by a chat application?</li> <li>Q1025 \u00a0What external accounts has the actor used in their web browser?</li> <li>Q1038 \u00a0Were any files sent via CLI utilities?</li> <li>Q1084 \u00a0What data was uploaded to a website via a web browser?</li> </ul>"},{"location":"scenarios/S1001/#system-information-f1012","title":"System Information F1012","text":"<ul> <li>Q1008 \u00a0What programs are installed on a computer?</li> <li>Q1081 \u00a0Does the user have a recently provisioned host?</li> </ul>"},{"location":"scenarios/S1001/#were-any-files-sent-via-other-network-media-f1026","title":"Were any files sent via other network media? F1026","text":"<ul> <li>Q1082 \u00a0Were any files sent via AirDrop?</li> <li>Q1083 \u00a0Were any files sent via Bluetooth?</li> </ul>"},{"location":"scenarios/S1002/","title":"Data Infiltration","text":"<p>UUID: 7c4066fb-526b-43ea-9850-6fa1f797cdc4 ID: S1002</p> <p>Description: An employee is suspected of taking confidential information or trade secrets from a prior employer and introducing it to internal systems.</p>"},{"location":"scenarios/S1002/#are-any-externalcompany-related-files-on-the-actors-assigned-company-assets-f1001","title":"Are any ExternalCompany-related files on the actor's assigned Company assets? F1001","text":"<p>An actor may bring unauthorized external intellectual property onto Company \"end user\" devices (like laptops or desktops). Depending on the time frame under consideration, past devices that the actor no longer actively uses may need to be examined as well.</p> <ul> <li>Q1005 \u00a0What files have ever been on a computer?</li> <li>Q1006 \u00a0What files are present on a computer?</li> <li>Q1014 \u00a0What files did the actor open on their computer?</li> <li>Q1027 \u00a0Are there any sudden changes in the number of files on a device?</li> </ul>"},{"location":"scenarios/S1002/#has-the-actor-introduced-any-externalcompany-files-to-company-assets-via-downloading-f1002","title":"Has the actor introduced any ExternalCompany files to Company assets via downloading? F1002","text":"<ul> <li>Q1001 \u00a0What files were downloaded using a web browser?</li> <li>Q1008 \u00a0What programs are installed on a computer?</li> <li>Q1009 \u00a0What interactions with external cloud storage sites did the actor have using their web browser?</li> <li>Q1015 \u00a0What syncing activities did external \"cloud storage\" applications do on a computer?</li> <li>Q1025 \u00a0What external accounts has the actor used in their web browser?</li> <li>Q1026 \u00a0What files were downloaded from messaging apps?</li> <li>Q1031 \u00a0How much network traffic was there to/from a machine?</li> </ul>"},{"location":"scenarios/S1002/#has-the-actor-introduced-any-externalcompany-files-to-company-assets-via-removable-storage-devices-f1003","title":"Has the actor introduced any ExternalCompany files to Company assets via removable storage devices? F1003","text":"<ul> <li>Q1002 \u00a0What USB devices were attached to a computer?</li> <li>Q1012 \u00a0What files were copied from a USB device to a computer?</li> <li>Q1013 \u00a0What files are present on a USB device?</li> </ul>"},{"location":"scenarios/S1002/#are-there-any-indications-of-communication-with-externalcompany-f1029","title":"Are there any indications of communication with ExternalCompany? F1029","text":"<p>An actor may be exchanging information with an external company, commonly via websites or email messages. The following Questions are broad, and the results will need to be filtered for terms related to the external company.</p> <ul> <li>Q1020 \u00a0What pages did web browsers visit?</li> <li>Q1084 \u00a0What data was uploaded to a website via a web browser?</li> <li>Q1085 \u00a0What DNS requests have been made from a system?</li> <li>Q1086 \u00a0What web-based email messages were viewed in a web browser?</li> </ul>"},{"location":"scenarios/S1002/#has-the-actor-connected-to-any-externalcompany-systems-f1030","title":"Has the actor connected to any ExternalCompany systems? F1030","text":"<p>An actor may be connecting to services or systems associated with ExternalCompany, possibly through a client, a terminal, or a web browser.</p> <ul> <li>Q1087 \u00a0Did the user access any common PaaS/SaaS services?</li> <li>Q1088 \u00a0Did the user connect to any non-Company systems using the command line?</li> <li>Q1089 \u00a0Did the user download any Citrix configuration (.ica) files?</li> <li>Q1090 \u00a0Did the user interact with any git repositories?</li> </ul>"},{"location":"scenarios/S1003/","title":"Suspicious DNS Query","text":"<p>UUID: 5305f225-b274-4fc4-b60f-a87d9e2a7c11 ID: S1003</p> <p>Description: A DNS query to an unexpected domain can be an indicator of abnormal activity on a host. If a domain has been marked as malicious, an investigator may be tasked with determining what caused the DNS query (or response) and if it indicates the host has been compromised.</p>"},{"location":"scenarios/S1003/#what-application-was-responsible-for-the-dns-query-f1004","title":"What application was responsible for the DNS query? F1004","text":"<p>What application made a DNS request is important for determining if it is likely legitimate or not. The source also impacts further investigative steps (depending on if <code>powershell.exe</code> or <code>chrome.exe</code> were responsible, different artifacts would be useful).</p> <ul> <li>Q1018 \u00a0What process made the DNS query?</li> <li>Q1073 \u00a0Have there been any modifications to the \"hosts\" file?</li> </ul>"},{"location":"scenarios/S1003/#was-a-users-web-browsing-the-cause-of-a-given-dns-query-f1005","title":"Was a user's web browsing the cause of a given DNS query? F1005","text":"<p>Understanding if a user's actions in a web browser caused a particular DNS query is valuable context when investigating a suspicious DNS query. If the query is related to the user's actions, closer scrutiny of their browser activity may make sense. If the DNS doesn't appear related, you may need to look into the actions of other non-browser processes.</p> <ul> <li>Q1019 \u00a0What web browsers were running at a given time?</li> <li>Q1020 \u00a0What pages did web browsers visit?</li> <li>Q1024 \u00a0Was an Incognito/Private browser session used?</li> <li>Q1072 \u00a0Did Chrome's DNS Prefetching cause a DNS query?</li> </ul>"},{"location":"scenarios/S1003/#was-a-browser-extension-responsible-for-a-dns-query-f1006","title":"Was a browser extension responsible for a DNS query? F1006","text":"<p>A malicious (or potentially unwanted) extension may generate DNS queries itself, inject or modify legitimate requests, or manipulate the user's browsing experience in some other way.</p> <ul> <li>Q1021 \u00a0What Chrome extensions are installed?</li> <li>Q1022 \u00a0What actions did a Chrome extension perform?</li> <li>Q1023 \u00a0Is a given Chrome extension associated with a given domain?</li> </ul>"},{"location":"scenarios/S1005/","title":"Cloud Project Compromise Assessment","text":"<p>UUID: 716752f6-1580-461d-9d07-387d2e8784bf ID: S1005</p> <p>Description: Evaluate a cloud project for malicious or unknown activities and determine if the cloud project is compromised. This is distinct from evaluating whether a particular instance in that cloud project is compromised.</p>"},{"location":"scenarios/S1005/#has-an-attacker-gained-access-to-the-cloud-project-initial-access-f1013","title":"Has an attacker gained access to the cloud project? (Initial Access) F1013","text":"<ul> <li>Q1039 \u00a0Are there any detections of exposed service account credentials?</li> <li>Q1040 \u00a0Are there any interaction with the cloud project resources from an unknown external IP address (including Tor Exit nodes, C2 tagged addresses)?</li> <li>Q1041 \u00a0Are there any unexpected successful API calls from an unknown external IP address (including Tor Exit nodes, C2 tagged addresses)?</li> </ul>"},{"location":"scenarios/S1005/#are-there-any-signs-of-an-attacker-trying-to-maintain-access-to-the-cloud-project-persistence-f1014","title":"Are there any signs of an attacker trying to maintain access to the cloud project? (Persistence) F1014","text":"<ul> <li>Q1042 \u00a0Are there any APIs recently enabled?</li> <li>Q1043 \u00a0Are there any role bindings to cluster admin for anonymous users?</li> <li>Q1044 \u00a0Are there any unexpected resources created under the cloud project?</li> <li>Q1045 \u00a0Are there any unknown accounts created?</li> <li>Q1046 \u00a0Are there any unknown role bindings created?</li> </ul>"},{"location":"scenarios/S1005/#are-there-any-signs-of-interference-with-cloud-project-protective-measures-defense-evasion-f1015","title":"Are there any signs of interference with cloud project protective measures? (Defense Evasion) F1015","text":"<ul> <li>Q1047 \u00a0Are there any suspicious modifications to the cloud project firewall rules/policies?</li> <li>Q1048 \u00a0Are there any suspicious modifications to the cloud project logging configuration?</li> </ul>"},{"location":"scenarios/S1005/#are-there-indications-of-an-attacker-moving-between-resources-f1016","title":"Are there indications of an attacker moving between resources? F1016","text":"<p>This may take the form of an attacker moving between cloud resources within the project or between the cloud project and on-prem systems.</p> <ul> <li>Q1049 \u00a0Is there an unusual increase of traffic between resource in the cloud project?</li> </ul>"},{"location":"scenarios/S1005/#are-there-any-signs-of-data-exfiltration-from-resources-inside-the-cloud-project-data-exfil-f1017","title":"Are there any signs of data exfiltration from resources inside the cloud project? (Data Exfil) F1017","text":"<ul> <li>Q1050 \u00a0Are there any GCS buckets within the cloud project shared externally?</li> <li>Q1051 \u00a0Are there any signs of data within the cloud project being transferred externally?</li> </ul>"},{"location":"scenarios/S1005/#are-there-any-detections-of-potentially-suspicious-activity-related-to-the-cloud-project-from-detection-tools-f1018","title":"Are there any detections of potentially suspicious activity related to the cloud project from detection tools? F1018","text":"<ul> <li>Q1039 \u00a0Are there any detections of exposed service account credentials?</li> </ul>"},{"location":"scenarios/S1007/","title":"Host Persistence Audit","text":"<p>UUID: e8539ec2-53c2-492c-9070-6e4955d38f11 ID: S1007</p> <p>Description: Once an attacker is on a system, a main goal becomes trying to maintain that access. Persistence mechanisms give the attacker the ability to run malware that will survive reboots and credential changes.</p>"},{"location":"scenarios/S1007/#was-a-browser-extension-used-to-maintain-a-foothold-f1019","title":"Was a browser extension used to maintain a foothold? F1019","text":"<ul> <li>Q1021 \u00a0What Chrome extensions are installed?</li> <li>Q1052 \u00a0What browser extensions (non-Chrome) are installed?</li> </ul>"},{"location":"scenarios/S1007/#are-there-any-interesting-logon-or-boot-initialization-scripts-f1020","title":"Are there any interesting logon or boot initialization scripts? F1020","text":"<ul> <li>Q1053 \u00a0What Launch Agents are configured?</li> <li>Q1054 \u00a0What Launch Daemons are configured?</li> <li>Q1055 \u00a0What Windows logon scripts are configured?</li> <li>Q1056 \u00a0What login hooks are configured?</li> <li>Q1057 \u00a0What network logon scripts are configured?</li> </ul>"},{"location":"scenarios/S1007/#are-there-any-new-accounts-that-have-been-created-f1021","title":"Are there any new accounts that have been created? F1021","text":"<ul> <li>Q1058 \u00a0What domain accounts have been created?</li> <li>Q1059 \u00a0What local accounts have been created?</li> </ul>"},{"location":"scenarios/S1007/#are-there-any-scheduledautomated-tasks-that-ran-f1022","title":"Are there any scheduled/automated tasks that ran? F1022","text":"<ul> <li>Q1060 \u00a0What AT jobs are configured?</li> <li>Q1061 \u00a0What Scheduled Tasks are configured?</li> <li>Q1062 \u00a0What cron jobs are configured?</li> <li>Q1063 \u00a0What periodic scripts are configured?</li> <li>Q1064 \u00a0What systemd timers are configured?</li> </ul>"},{"location":"scenarios/S1007/#are-there-any-suspicious-files-running-at-system-boot-or-login-autoruns-f1023","title":"Are there any suspicious files running at system boot or login autoruns? F1023","text":"<ul> <li>Q1065 \u00a0What files are referenced in Registry \"Run\" keys?</li> <li>Q1066 \u00a0What items are in startup folders?</li> </ul>"},{"location":"scenarios/S1007/#has-a-system-process-been-created-or-modified-f1024","title":"Has a system process been created or modified? F1024","text":"<ul> <li>Q1067 \u00a0What system services are installed?</li> <li>Q1068 \u00a0When were system services last modified?</li> </ul>"},{"location":"scenarios/S1007/#are-there-any-indications-of-hijacking-execution-flows-f1025","title":"Are there any indications of hijacking execution flows? F1025","text":"<ul> <li>Q1069 \u00a0Are there any indications of dylib hijacking?</li> <li>Q1070 \u00a0Are there any indications of dylib proxying?</li> <li>Q1071 \u00a0Are there any indications of dynamic linker hijacking?</li> </ul>"},{"location":"scenarios/S1008/","title":"Lateral Movement","text":"<p>UUID: 098db976-2553-4df2-b1c1-f341652a0549 ID: S1008</p> <p>Description: Lateral movement is the process of an attacker moving from one system to another within a network after they have gained initial access to a system. This can be done through a variety of methods, such as exploiting vulnerabilities in software, using stolen credentials, installing their own remote access tools, or using native system utilities.</p>"},{"location":"scenarios/S1008/#are-there-any-new-accounts-that-have-been-created-f1021","title":"Are there any new accounts that have been created? F1021","text":"<ul> <li>Q1058 \u00a0What domain accounts have been created?</li> <li>Q1059 \u00a0What local accounts have been created?</li> </ul>"},{"location":"scenarios/S1008/#are-the-indications-of-an-attacker-moving-from-this-host-to-another-f1027","title":"Are the indications of an attacker moving FROM this host to another? F1027","text":"<p>Once an attacker has access to a system, they may want to use it to pivot to a different system. This movement, from a source host to a destination host, leaves traces on both the source and destination hosts. A given system may be both the source and destination of lateral movement at different times. This facet examines a host for indications it was the source host, meaning an attacker moved FROM it to a different destination system.</p> <ul> <li>Q1036 \u00a0Have there been any executions of PsExec?</li> </ul>"},{"location":"scenarios/S1008/#are-the-indications-of-an-attacker-moving-to-this-host-f1028","title":"Are the indications of an attacker moving TO this host? F1028","text":"<p>Once an attacker has access to a system, they may want to use it to pivot to a different system. This movement, from a source host to a destination host, leaves traces on both the source and destination hosts. A given system may be both the source and destination of lateral movement at different times. This facet examines a host for indications it was the destination host, meaning an attacker moved TO it from a different system.</p> <ul> <li>Q1037 \u00a0Have there been any executions of PsExeSrv?</li> </ul>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#chrome","title":"Chrome","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#crowdstrike","title":"CrowdStrike","text":"<ul> <li>What process made the DNS query?</li> <li>What web browsers were running at a given time?</li> <li>Was an Incognito/Private browser session used?</li> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#dns","title":"DNS","text":"<ul> <li>What process made the DNS query?</li> </ul>"},{"location":"tags/#edge","title":"Edge","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#event-logs","title":"Event Logs","text":"<ul> <li>Have there been any executions of PsExec?</li> <li>Have there been any executions of PsExeSrv?</li> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#firefox","title":"Firefox","text":"<ul> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#internet-explorer","title":"Internet Explorer","text":"<ul> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#linux","title":"Linux","text":"<ul> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#ntfs","title":"NTFS","text":"<ul> <li>What files were downloaded using a web browser?</li> </ul>"},{"location":"tags/#prefetch","title":"Prefetch","text":"<ul> <li>Have there been any executions of PsExec?</li> <li>Have there been any executions of PsExeSrv?</li> </ul>"},{"location":"tags/#process-execution","title":"Process Execution","text":"<ul> <li>What web browsers were running at a given time?</li> <li>Was an Incognito/Private browser session used?</li> </ul>"},{"location":"tags/#sqlite","title":"SQLite","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#safari","title":"Safari","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What pages did web browsers visit?</li> </ul>"},{"location":"tags/#sysmon","title":"Sysmon","text":"<ul> <li>What process made the DNS query?</li> </ul>"},{"location":"tags/#t1070001","title":"T1070.001","text":"<ul> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#t1070002","title":"T1070.002","text":"<ul> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#usn-journal","title":"USN Journal","text":"<ul> <li>What files were downloaded using a web browser?</li> </ul>"},{"location":"tags/#web-browser","title":"Web Browser","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What web browsers were running at a given time?</li> <li>What pages did web browsers visit?</li> <li>Was an Incognito/Private browser session used?</li> </ul>"},{"location":"tags/#windows","title":"Windows","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>What process made the DNS query?</li> <li>Have there been any executions of PsExec?</li> <li>Have there been any executions of PsExeSrv?</li> <li>Were any system event logs cleared?</li> </ul>"},{"location":"tags/#macos","title":"macOS","text":"<ul> <li>What files were downloaded using a web browser?</li> <li>Were any system event logs cleared?</li> </ul>"}]}